{% extends 'base.html' %}

{% block title %}
  {{ person.name }} - {{ block.super }}
{% endblock %}

{% block breadcrumb %}
  <li class="breadcrumb-item active">Visiting {{ person.username }}</li>
  <li class="breadcrumb-item"><a href="{% url 'profile_home' %}"><button class="btn"><i class="fa fa-home"></i> Home</button></a></li>
  <li class="breadcrumb-item"><button class="btn" onClick="javascript:history.go(-1);"></i>&#9756;Back</button></a></li>
  <li class="breadcrumb-item"><a href="{% url 'send_message' person.pk %}"><button class="btn">&#9993;Send Message</button></a></li>
  <li class="breadcrumb-item"><a href="{% url 'appointment_day' person.pk %}"><button class="btn">Make appointment</button></a></li>
{% endblock %}
{% block content %}
<button type="button" onClick="window.location.reload();">Refresh</button>
<div class="row">
 <div class="col-sm-6">
   <h2>{{ person.username }}</h2>
     <span class="stars">{{ final_rating }}</span>
     <h5>Rating {{ final_rating }}/5 &nbsp; <sub>Raters: {{ rater }}</sub></h5>
    <img src="{{ person.profile_pic.url }}"  width="100px" alt="">
    <ul>
        <li>First name= {{ person.first_name }}</li>
        <li>Last name= {{ person.last_name }}</li>
        <li>Email= {{ person.email }}</li>
         <li>Phone number= {{ person.phone_number }}</li>
         <li>Gender= {{ person.gender }}</li>
         <li>Date of birth= {{ person.date_of_birth }}</li>
         <li>Address= {{ person.address }}</li>
    {% if person.is_normal %}
    {% elif person.is_professional %}
         <li>Profession= {{ person.professional.profession }}</li>
         <li>Speciality= {{ person.professional.speciality }}</li>
    </ul>
    {% endif %}

  </div>

    <div class="col-sm-6">

        <button onClick="Schedule()">
            Appointment Schedule
        </button>
        <br>

        <div id="schedule" style="display:none">
              <table class="table">
        <thead class="thead-inverse">
        </thead>
          <tr>
              <thread class="thead-inverse">
                  <th></th>
                  <th>Start Time</th>
                  <th>End Time</th>
              </thread>
          </tr>
        <tbody>
        {% if sat %}
        <th class="align-middle" rowspan="{{ sat }}">Saturday</th>
        {% for schedule in appointment_schedule %}
            {% if schedule.day == "Saturday" %}
            <tr>
                <td class="align-middle">{{ schedule.start_time }}</td>
                <td class="align-middle">{{ schedule.end_time }}</td>
            </tr>
            {% endif %}
        {% endfor %}
        {% endif %}
        {% if sun %}
        <th class="align-middle" rowspan="{{ sun }}">Sunday</th>
        {% for schedule in appointment_schedule %}
            {% if schedule.day == "Sunday" %}
            <tr>
                <td class="align-middle">{{ schedule.start_time }}</td>
                <td class="align-middle">{{ schedule.end_time }}</td>
            </tr>
            {% endif %}
        {% endfor %}
        {% endif %}
        {% if mon %}
        <th class="align-middle" rowspan="{{ mon }}">Monday</th>
        {% for schedule in appointment_schedule %}
            {% if schedule.day == "Monday" %}
            <tr>
                <td class="align-middle">{{ schedule.start_time }}</td>
                <td class="align-middle">{{ schedule.end_time }}</td>
            </tr>
            {% endif %}
        {% endfor %}
        {% endif %}
        {% if tue %}
        <th class="align-middle" rowspan="{{ tue }}">Tuesday</th>
        {% for schedule in appointment_schedule %}
            {% if schedule.day == "Tuesday" %}
            <tr>
                <td class="align-middle">{{ schedule.start_time }}</td>
                <td class="align-middle">{{ schedule.end_time }}</td>
            </tr>
            {% endif %}
        {% endfor %}
        {% endif %}
        {% if wed %}
        <th class="align-middle" rowspan="{{ wed }}">Wednesday</th>
        {% for schedule in appointment_schedule %}
            {% if schedule.day == "Wednesday" %}
            <tr>
                <td class="align-middle">{{ schedule.start_time }}</td>
                <td class="align-middle">{{ schedule.end_time }}</td>
            </tr>
            {% endif %}
        {% endfor %}
        {% endif %}
        {% if thus %}
        <th class="align-middle" rowspan="{{ thus }}">Thursday</th>
        {% for schedule in appointment_schedule %}
            {% if schedule.day == "Thursday" %}
            <tr>
                <td class="align-middle">{{ schedule.start_time }}</td>
                <td class="align-middle">{{ schedule.end_time }}</td>
            </tr>
            {% endif %}
        {% endfor %}
        {% endif %}
        {% if fri %}
        <th class="align-middle" rowspan="{{ fri }}">Friday</th>
        {% for schedule in appointment_schedule %}
            {% if schedule.day == "Friday" %}
            <tr>
                <td class="align-middle">{{ schedule.start_time }}</td>
                <td class="align-middle">{{ schedule.end_time }}</td>
            </tr>
            {% endif %}
        {% endfor %}
        {% endif %}
        </tbody>
      </table>
        </div>
        <button onClick="Rate()">
            Rate
        </button>
        <br>
        <div id="rate" style="display:none">
            <form method="post">
              {% csrf_token %}
              <table class="form form-table">
                {{ form_rate }}
                  <div>
                    {% if messages %}
                      <ul class="messages">
                        {% for message in messages %}
                            <li style="color:red">{{ message }}</li>
                        {% endfor %}
                      </ul>
                    {% endif %}
                  </div>
                <tr><td colspan="2"><button type="submit"  name="_rate" class="btn btn-info right"> Rate </button></td></tr>
              </table>
            </form>
        </div>
        <button onClick="Reviews()">
            Reviews
        </button>
        <br>
        <div id="reviews" style="display:none">
            <div class="wrapper">
                <p>
                    {% for rev in reviews %}
                    <div class="panel panel-default">
                      <div class="panel-heading"><span class="label label-info" style="">{{ rev.rate_from }}</span> {{ rev.rating }}/5</div>
                      <div class="panel-body">{{ rev.review }}</div>
                    </div>
                    {% endfor %}
                </p>
            </div>
        </div>
    </div>


</div>
    <script>
        $('#GFG_UP').text(
"Click on button to toggle the DIV Box using Bootstrap.");

        function toggler(divId) {
            $("#" + divId).toggle();
        }

        function Schedule() {
            toggler('schedule');
            $('#GFG_DOWN').text("DIV Box is toggling.");
        }

        function Rate() {
            toggler('rate');
            $('#GFG_DOWN').text("DIV Box is toggling.");
        }

        function Reviews() {
            toggler('reviews');
            $('#GFG_DOWN').text("DIV Box is toggling.");
        }



    </script>


{% endblock %}

